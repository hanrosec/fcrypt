#include "pbkdf.h"

void pbkdf(char *password, size_t password_len, u8 *key, size_t key_size) {
    u8 salt[] = {
        0x61, 0x20, 0x6e, 0x6f,
        0x74, 0x68, 0x69, 0x6e,
        0x67, 0x2d, 0x75, 0x70,
        0x2d, 0x6d, 0x79, 0x2d,
        0x73, 0x6c, 0x65, 0x65,
        0x76, 0x65, 0x20, 0x73,
        0x61, 0x6c, 0x74};
    if (PKCS5_PBKDF2_HMAC(password, password_len, salt, sizeof(salt), 4096, EVP_sha1(), key_size, key) == 0) {
        fprintf(stderr, "error deriving key!");
    }
}
